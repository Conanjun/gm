<extend name="Public/base"/>
<block name="body">
    <!--编辑器-->
    <script src="__JSNEW__/ckeditor/ckeditor.js"></script>
    <script src="__JSNEW__/ckeditor/adapters/jquery.js"></script>
    <!--上传-->
    <script src="__JSNEW__/all.fine-uploader/all.fine-uploader.min.js"></script>
    <link href="__JSNEW__/all.fine-uploader/fine-uploader-gallery.min.css" rel="stylesheet"/>
    <link href="__JSNEW__/all.fine-uploader/fine-uploader-new.min.css" rel="stylesheet"/>
    <!--验正-->
    <script src='__JSNEW__/jquery.validate.min.js' type='text/javascript'></script>
    <!--时间插件-->
    <script src="__JS__/in/plugins/datapicker/bootstrap-datepicker.js"></script>
    <script src="__JS__/in/plugins/daterangepicker/daterangepicker.js"></script>
    <link href="__CSS__/n.css" rel="stylesheet"  type="text/css" />

    <link href="__CSS__/in/iviews-order.css" rel="stylesheet">
    <link href="__CSS__/in/piezas_dentales.css" rel="stylesheet">
    <!-- plugin -->
    <link href="__CSS__/in/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="__CSS__/in/plugins/datapicker/datepicker3.css" rel="stylesheet">
    <link href="__CSS__/in/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet">

    <link href="__CSS__/in/iviews-order.css" rel="stylesheet">

    <!--抓取局部截图-->
    <script src="__JS__/in/plugins/html2canvas/html2canvas.js"></script>
    <!--数据渲染模板-->
    <script src="__JS__/in/vue.js"></script>
    <link href="__CSS__/in/plugins/datapicker/datepicker3.css" rel="stylesheet">
    <link href="__CSS__/in/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet">

    <link href="__CSS__/in/stylesheet.css" rel="stylesheet">
    <link href="__CSS__/in/iviews-order.css" rel="stylesheet">

    <link href="__CSS__/in/piezas_dentales.css" rel="stylesheet">
    <style>
        #tt_3,#tt_2,#tt_4,#tt_5,#tt_6{display: none}
        .formbtn:hover{
            color:#333333
        }
        .qq-upload-button {
            width: 192px;
            height: 100px;
            border: 0;
            background: url("__ROOT__/admin/images/plus.png") no-repeat center center #efefef;
            border: 0;
            background-size: 50px;
        }
        .qq-upload-list-selector li{position: relative;}
        .pdel {
            background: url('__ROOT__/admin/images/cl.png') no-repeat left top;
            position: absolute;
            width: 14px;
            height: 14px;
            top: -5px;
            right:-5px;
            z-index: 1;
        }
        .qq-thumbnail-selector {
            vertical-align: middle;
            margin-right: 0px;
            width: 200px;
        }
        ul{
            list-style-type:none;
            margin: 0;
            padding: 0;
        }
        .sitem li.lion {
            background: #1ab394;
            color: #fff;
        }
        .sitem li{
            float: left;
            background: #f2f2f2;
            height: 25px;
            line-height: 25px;
            margin-right: 10px;
            padding: 0 10px;
            -webkit-border-radius: 2px;
            -moz-border-radius: 2px;
            border-radius: 2px;
            cursor: pointer;
            color: #888;
            transition: 0.3s;
        }

    </style>
    <script>
        $(function(){
            $("[id^='li_']").click(function(){
                var h=$(this).attr("h");
                var item=$(this).attr("item");
                if(h==0){
                    $(this).attr("h",1);
                    $(this).addClass("lion");
                    $("#ss_"+item).val(item);
                }else if(h==1){
                    $(this).attr("h",0);
                    $(this).removeClass("lion");
                    $("#ss_"+item).val("");
                }
            });
            $('#form').validate({
                errorPlacement: function (error, element) {
                    $(element).parent().append(error);
                },
                onkeyup: false,
                rules: {
                    name: {
                        required: true,
                    },
                    description: {
                        required: true,
                    },
                    regionid: {
                        required: true,
                    }
                },
                messages: {
                    name: {
                        required : '请填写名称'
                    },
                    description: {
                        required : '请填写说明'
                    },
                    regionid: {
                        required : '请选择区域'
                    }
                }
            });
            $("[id^='t_']").click(function(){
                $("[id^='t_']").parent().removeClass("active");
                $(this).parent().addClass("active");
                $("[id^='tt_']").hide();
                $("#t"+$(this).attr("id")).show();
            });
            $('.ser_type').click(function(){
                $("[id^='t_']").parent().removeClass("active");
                var sid = $(this).attr('val');
                $("input[name='sid']").val(sid);
                $("[id^='tt_']").hide();
                $("#tt_2").show();
                $("#t_2").parent().addClass("active");
            });
            $('.execute').click(function(){
                $("[id^='t_']").parent().removeClass("active");
                var $id = $(this).attr('value');
                $("[id^='tt_']").hide();
                $("#tt_"+$id).show();
                $("#t_"+$id).parent().addClass("active");
            });
        });
        /*根据出生日期算出年龄*/
        function setage(strBirthday){
            var returnAge;
            var $time = $(strBirthday).val();
            if($time == '' || $time ==undefined  || $time == null  ){
                return false;
            }
            var strBirthdayArr=$time.split("-");
            var birthYear = strBirthdayArr[0];
            var birthMonth = strBirthdayArr[1];
            var birthDay = strBirthdayArr[2];

            var d = new Date();
            var nowYear = d.getFullYear();
            var nowMonth = d.getMonth() + 1;
            var nowDay = d.getDate();

            if (nowYear == birthYear) {
                returnAge = '';//同年 则为0岁
            }else {
                var ageDiff = nowYear - birthYear; //年之差
                if (ageDiff > 0) {
                    if (nowMonth == birthMonth) {
                        var dayDiff = nowDay - birthDay;//日之差
                        if (dayDiff < 0) {
                            returnAge = ageDiff - 1;
                        }else {
                            returnAge = ageDiff;
                        }
                    } else {
                        var monthDiff = nowMonth - birthMonth;//月之差
                        if (monthDiff < 0) {
                            returnAge = ageDiff - 1;
                        }else {
                            returnAge = ageDiff;
                        }
                    }
                }else {
                    returnAge = '';//返回-1 表示出生日期输入错误 晚于今天
                }
            }
            if(returnAge == 0){
                returnAge = '';
            }
            $("#age").html(returnAge);
            $("input[name='age']").val(returnAge);
        }

    </script>
    <!-- content begin -->
    <div class="wrapper wrapper-content" id="app">

        <!-- in+ dom -->
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <!-- title -->
                    <div class="ibox-title">
                        <h5>
                            {:L('ORDER_MANAGE')}
                            <small>{:L('ADD')}</small>
                        </h5>
                        <div class="ibox-button">
                            <a href="javascript:history.go(-1);" class="btn btn-primary btn-sm" type="button">{:L('BACK')}</a>
                        </div>

                    </div>
                    <!-- content -->
                    <div class="iviews-order ibox-content">

                        <div class="row iviews-steps steps">
                            <ul>
                                <li v-for="( item , $index ) in stepArr" :index="$index" :data-index="$index" :class="{ active: stepArr[$index].active , error: stepArr[$index].error }" @click="tab($index)">
                                    {{ item.name }}
                                </li>
                            </ul>
                        </div>
                        <!-- <div id="tt_1">
                             <volist name="types" id="vo">
                                 <div class="ser_type" val="{$vo.sid}" style="width: 120px;height: 120px;border: 1px solid red">
                                     {$vo['d_value']|L}
                                 </div>
                             </volist>
                             <input type="hidden" name="sid" value="">
                         </div>-->
                        <!-- step2// -->
                        <div class="iviews-order-content iviews-order-step2" v-show="stepArr[1].show">

                            <div class="iviews-order-form">

                                <form method="get" class="form-horizontal">
                                    <div class="form-group" >
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">
                                            {:L('PROCESSING_MODE')}
                                        </label>
                                        <volist name="processing_modem" id="vo" >
                                            <div class="col-sm-2">
                                                <div class="i-checks">
                                                    <label class="control-label">
                                                        <input type="checkbox" name="step2type" value="{$vo.d_key}" >
                                                        <i></i> {$vo.d_value|L}
                                                    </label>
                                                </div>
                                            </div>
                                        </volist>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">
                                            {:L('NORMALS')}
                                        </label>
                                        <div class="col-sm-4">
                                            <select name="" class="form-control" @change="step2Server">
                                                <option value="">{:L('PLEASE_SELECT')}</option>
                                                <option :value="item.planid"  :index="$index" v-for="(item , $index) in step2.serverArr">{{ item.pname }}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">
                                            {:L('OTHERS')}
                                        </label>
                                        <div class="col-sm-6">
                                            <ul class="iviews-type clearfix">
                                                <li v-for="(item , $index) in step2.otherArr" :value="item.planid" :index="$index">{{ item.pname }}</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">
                                            {:L('ORDER_UG')}
                                        </label>
                                        <div class="col-sm-2">
                                            <div class="i-checks inline">
                                                <label class="control-label">
                                                    <input type="radio" name="step2Urgent" value="1" :checked="step2.urgent == 1">
                                                    <i></i> {:L('YES')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-2">
                                            <div class="i-checks">
                                                <label class="control-label">
                                                    <input type="radio" name="step2Urgent" value="0" :checked="!step2.urgent == 1">
                                                    <i></i>{:L('NO')}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group iviews-actions">
                                        <div class="col-sm-3 col-sm-offset-1">
                                            <button type="button" @click="step2submit" class="btn btn-primary btn-block">{:L('NEXT')}</button>
                                        </div>
                                    </div>
                                </form>

                            </div>

                        </div>

                        <!-- step3// -->
                        <div class="iviews-order-content iviews-order-step3" v-show="stepArr[2].show">
                            <div class="ibox-content iviews-order-form">

                                <form method="get" class="form-horizontal">

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">
                                            {:L('C_NAME')}
                                        </label>
                                        <div class="col-sm-4">
                                            <p class="form-control-static">{{ step3.clinic.name }}</p>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('DEINFO')}
                                        </label>
                                        <div class="col-sm-4">
                                            <p class="form-control-static">{{ step3.clinic.address }}</p>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('SHIPINFO')}
                                        </label>
                                        <div class="col-sm-4">
                                            <p class="form-control-static">{{ step3.mailing.name }} &emsp; {{ step3.mailing.phone }}</p>
                                            <p class="form-control-static">
                                                <span v-show="step3.mailing.address !== ''">{{ step3.mailing.address }}</span>
                                                <a data-trigger="modal" data-title="{:L('ADD_ADDRESS')}" data-width="600PX" href="{:U('Addess/edit')}"v-if="step3.mailing.address !== ''">{:L('EDIT')}</a>
                                                <a data-trigger="modal" data-title="{:L('ADD_ADDRESS')}" data-width="600PX" href="{:U('Addess/add')}" v-else>{:L('ADD')}</a>
                                            </p>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">
                                            {:L('DOCINFO')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" name="doctor" @keydown="rclass" value="" v-model="step3.team.doctor">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('DOCINFO_TEL')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" name="doctor_tel" @keydown="rclass" value="" v-model="step3.team.doctorTel">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('DOCOSSINFO')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" name="doctorAssistant" @keydown="rclass" value="" v-model="step3.team.doctorAssistant">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('DOCOSSINFO_TEL')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" name="doctorAssistantTel" @keydown="rclass" value="" v-model="step3.team.doctorAssistantTel">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('ADOCINFO')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" name="referralDoctor"  value="" v-model="step3.team.referralDoctor">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('ADOCINFO_TEL')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" name="referralDoctorTel"  value="" v-model="step3.team.referralDoctorTel">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('ADOCOSSINFO')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" name="referralAssistant" value="" v-model="step3.team.referralAssistant">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('ADOCOSSINFO_TEL')}
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" name="referralAssistantTel"  value="" v-model="step3.team.referralAssistantTel">
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group iviews-actions">
                                        <div class="col-sm-3 col-sm-offset-1">
                                            <button type="button" class="btn btn-primary btn-block" @click="step3submit"> {:L('NEXT')}</button>
                                        </div>
                                    </div>

                                </form>

                            </div>
                        </div>
                        <!-- step4// -->
                        <div class="iviews-order-content iviews-order-step4" v-show="stepArr[3].show">

                            <div class="iviews-order-form">

                                <form method="" class="form-horizontal">

                                    <div class="form-group" id="name4">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('P_NAME')}</label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" name="name4" @keyup="rclass" v-model="step4.patient.name">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">
                                            {:L('SEX')}
                                        </label>
                                        <div class="col-sm-1">
                                            <div class="i-checks inline">
                                                <label class="control-label">
                                                    <input type="radio" name="sex" value="1" :checked="step4.patient.sex == 1">
                                                    <i></i>  {:L('MAN')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-1">
                                            <div class="i-checks">
                                                <label class="control-label">
                                                    <input type="radio" name="sex" value="2" :checked="step4.patient.sex == 2">
                                                    <i></i> {:L('WOMAN')}
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group" id="birthday">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">{:L('P_BR')}</label>
                                        <div class="col-sm-4">
                                            <div class="input-group">
                                                    <span class="input-group-addon">
                                                        <i class="fa fa-calendar"></i>
                                                    </span>
                                                <input type="text" class="form-control date" v-model="step4.patient.birthday" onchange="setage(this)">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label ">{:L('AGE')}</label>
                                        <div class="col-sm-4">
                                            <div class="input-group">
                                                <span id="age"></span>
                                                <input type="hidden" name="age"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-11 col-sm-offset-1 control-label border-l">{:L('PAZHUSHU')}</label>
                                        <div class="col-sm-11 col-sm-offset-1">
                                            <br>
                                            <div class="summernote">
                                                <textarea name="note1"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('REPAIRBODY')}</label>
                                        <volist name="isxft" id="vo">
                                            <div class="col-sm-1">
                                                <div class="i-checks">
                                                    <label class="control-label">
                                                        <input type="radio" name="xiufu" value="{$vo.d_key}" checked >
                                                        <i></i> {$vo.d_value|L}
                                                    </label>
                                                </div>
                                            </div>
                                        </volist>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">{:L('PERIOD')}</label>
                                        <volist name="isyzy" id="vo">
                                            <div class="col-sm-1">
                                                <div class="i-checks">
                                                    <label class="control-label">
                                                        <input type="radio" name="yan" value="{$vo.d_key}" checked >
                                                        <i></i> {$vo.d_value|L}
                                                    </label>
                                                </div>
                                            </div>
                                        </volist>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">{:L('TOOTHLOOSE')}</label>
                                        <volist name="issd" id="vo">
                                            <div class="col-sm-1">
                                                <div class="i-checks">
                                                    <label class="control-label">
                                                        <input type="radio" name="song" value="{$vo.d_key}" checked >
                                                        <i></i> {$vo.d_value|L}
                                                    </label>
                                                </div>
                                            </div>
                                        </volist>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">{:L('FIXTYPE')}</label>
                                        <div class="col-sm-4">
                                            <select name="" @change="step4repairtype" class="form-control">
                                                <option value="">{:L('PLEASE_SELECT')}</option>
                                                <option :value="item.d_key" v-for="(item , $index) in step4.repairtypeArr" :index="$index">{{ item.d_value }}</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group" id="surgery">
                                        <label class="col-sm-2 col-sm-offset-1 control-label">{:L('PLANOPTIME')}</label>
                                        <div class="col-sm-4">
                                            <div class="input-group">
                                                    <span class="input-group-addon">
                                                        <i class="fa fa-calendar"></i>
                                                    </span>
                                                <input type="text" class="form-control date" v-model="step4.date">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group iviews-actions">
                                        <div class="col-sm-3 col-sm-offset-1">
                                            <button type="button" class="btn btn-primary btn-block" @click="step4submit">{:L('NEXT')}</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!-- step5// -->
                        <div class="iviews-order-content iviews-order-step5" v-show="stepArr[4].show">

                            <div class="iviews-order-form">
                                <form method="" class="form-horizontal">
                                    <div class="form-group" style="overflow: hidden;">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('MISSTOOTH')}</label>
                                        <div id="img_pz" class="col-md-offset-1 col-md-11">
                                            <div id="pz_dentales">
                                                <div class="d_sup1 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup1" value="valuable" id="sup1">
                                                    <label for="sup1"></label>
                                                </div>
                                                <div class="d_sup2 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup2" value="valuable" id="sup2">
                                                    <label for="sup2"></label>
                                                </div>
                                                <div class="d_sup3 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup3" value="valuable" id="sup3">
                                                    <label for="sup3"></label>
                                                </div>
                                                <div class="d_sup4 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup4" value="valuable" id="sup4">
                                                    <label for="sup4"></label>
                                                </div>
                                                <div class="d_sup5 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup5" value="valuable" id="sup5">
                                                    <label for="sup5"></label>
                                                </div>
                                                <div class="d_sup6 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup6" value="valuable" id="sup6">
                                                    <label for="sup6"></label>
                                                </div>
                                                <div class="d_sup7 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup7" value="valuable" id="sup7">
                                                    <label for="sup7"></label>
                                                </div>
                                                <div class="d_sup8 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup8" value="valuable" id="sup8">
                                                    <label for="sup8"></label>
                                                </div>
                                                <div class="d_sup9 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup9" value="valuable" id="sup9">
                                                    <label for="sup9"></label>
                                                </div>
                                                <div class="d_sup10 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup10" value="valuable" id="sup10">
                                                    <label for="sup10"></label>
                                                </div>
                                                <div class="d_sup11 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup11" value="valuable" id="sup11">
                                                    <label for="sup11"></label>
                                                </div>
                                                <div class="d_sup12 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup12" value="valuable" id="sup12">
                                                    <label for="sup12"></label>
                                                </div>
                                                <div class="d_sup13 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup13" value="valuable" id="sup13">
                                                    <label for="sup13"></label>
                                                </div>
                                                <div class="d_sup14 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup14" value="valuable" id="sup14">
                                                    <label for="sup14"></label>
                                                </div>
                                                <div class="d_sup15 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup15" value="valuable" id="sup15">
                                                    <label for="sup15"></label>
                                                </div>
                                                <div class="d_sup16 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup16" value="valuable" id="sup16">
                                                    <label for="sup16"></label>
                                                </div>
                                                <!--INFERIOR-->
                                                <div class="d_inf1 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf1" value="valuable" id="inf1">
                                                    <label for="inf1"></label>
                                                </div>
                                                <div class="d_inf2 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf2" value="valuable" id="inf2">
                                                    <label for="inf2"></label>
                                                </div>
                                                <div class="d_inf3 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf3" value="valuable" id="inf3">
                                                    <label for="inf3"></label>
                                                </div>
                                                <div class="d_inf4 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf4" value="valuable" id="inf4">
                                                    <label for="inf4"></label>
                                                </div>
                                                <div class="d_inf5 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf5" value="valuable" id="inf5">
                                                    <label for="inf5"></label>
                                                </div>
                                                <div class="d_inf6 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf6" value="valuable" id="inf6">
                                                    <label for="inf6"></label>
                                                </div>
                                                <div class="d_inf7 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf7" value="valuable" id="inf7">
                                                    <label for="inf7"></label>
                                                </div>
                                                <div class="d_inf8 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf8" value="valuable" id="inf8">
                                                    <label for="inf8"></label>
                                                </div>
                                                <div class="d_inf9 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf9" value="valuable" id="inf9">
                                                    <label for="inf9"></label>
                                                </div>
                                                <div class="d_inf10 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf10" value="valuable" id="inf10">
                                                    <label for="inf10"></label>
                                                </div>
                                                <div class="d_inf11 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf11" value="valuable" id="inf11">
                                                    <label for="inf11"></label>
                                                </div>
                                                <div class="d_inf12 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf12" value="valuable" id="inf12">
                                                    <label for="inf12"></label>
                                                </div>
                                                <div class="d_inf13 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf13" value="valuable" id="inf13">
                                                    <label for="inf13"></label>
                                                </div>
                                                <div class="d_inf14 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf14" value="valuable" id="inf14">
                                                    <label for="inf14"></label>
                                                </div>
                                                <div class="d_inf15 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf15" value="valuable" id="inf15">
                                                    <label for="inf15"></label>
                                                </div>
                                                <div class="d_inf16 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf16" value="valuable" id="inf16">
                                                    <label for="inf16"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group" style="overflow: hidden;">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('SEEDTOOTH')}</label>
                                        <div id="img_pz_2" class="col-md-offset-1 col-md-11">
                                            <div id="pz_dentales_2">
                                                <div class="d_sup1 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup1" value="valuable" id="sup1_2">
                                                    <label for="sup1_2"></label>
                                                </div>
                                                <div class="d_sup2 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup2" value="valuable" id="sup2_2">
                                                    <label for="sup2_2"></label>
                                                </div>
                                                <div class="d_sup3 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup3" value="valuable" id="sup3_2">
                                                    <label for="sup3_2"></label>
                                                </div>
                                                <div class="d_sup4 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup4" value="valuable" id="sup4_2">
                                                    <label for="sup4_2"></label>
                                                </div>
                                                <div class="d_sup5 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup5" value="valuable" id="sup5_2">
                                                    <label for="sup5_2"></label>
                                                </div>
                                                <div class="d_sup6 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup6" value="valuable" id="sup6_2">
                                                    <label for="sup6_2"></label>
                                                </div>
                                                <div class="d_sup7 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup7" value="valuable" id="sup7_2">
                                                    <label for="sup7_2"></label>
                                                </div>
                                                <div class="d_sup8 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup8" value="valuable" id="sup8_2">
                                                    <label for="sup8_2"></label>
                                                </div>
                                                <div class="d_sup9 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup9" value="valuable" id="sup9_2">
                                                    <label for="sup9_2"></label>
                                                </div>
                                                <div class="d_sup10 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup10" value="valuable" id="sup10_2">
                                                    <label for="sup10_2"></label>
                                                </div>
                                                <div class="d_sup11 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup11" value="valuable" id="sup11_2">
                                                    <label for="sup11_2"></label>
                                                </div>
                                                <div class="d_sup12 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup12" value="valuable" id="sup12_2">
                                                    <label for="sup12_2"></label>
                                                </div>
                                                <div class="d_sup13 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup13" value="valuable" id="sup13_2">
                                                    <label for="sup13_2"></label>
                                                </div>
                                                <div class="d_sup14 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup14" value="valuable" id="sup14_2">
                                                    <label for="sup14_2"></label>
                                                </div>
                                                <div class="d_sup15 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup15" value="valuable" id="sup15_2">
                                                    <label for="sup15_2"></label>
                                                </div>
                                                <div class="d_sup16 diente">
                                                    <input type="checkbox" class="diente_sup" name="sup16" value="valuable" id="sup16_2">
                                                    <label for="sup16_2"></label>
                                                </div>
                                                <!--INFERIOR-->
                                                <div class="d_inf1 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf1" value="valuable" id="inf1_2">
                                                    <label for="inf1_2"></label>
                                                </div>
                                                <div class="d_inf2 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf2" value="valuable" id="inf2_2">
                                                    <label for="inf2_2"></label>
                                                </div>
                                                <div class="d_inf3 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf3" value="valuable" id="inf3_2">
                                                    <label for="inf3_2"></label>
                                                </div>
                                                <div class="d_inf4 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf4" value="valuable" id="inf4_2">
                                                    <label for="inf4_2"></label>
                                                </div>
                                                <div class="d_inf5 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf5" value="valuable" id="inf5_2">
                                                    <label for="inf5_2"></label>
                                                </div>
                                                <div class="d_inf6 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf6" value="valuable" id="inf6_2">
                                                    <label for="inf6_2"></label>
                                                </div>
                                                <div class="d_inf7 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf7" value="valuable" id="inf7_2">
                                                    <label for="inf7_2"></label>
                                                </div>
                                                <div class="d_inf8 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf8" value="valuable" id="inf8_2">
                                                    <label for="inf8_2"></label>
                                                </div>
                                                <div class="d_inf9 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf9" value="valuable" id="inf9_2">
                                                    <label for="inf9_2"></label>
                                                </div>
                                                <div class="d_inf10 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf10" value="valuable" id="inf10_2">
                                                    <label for="inf10_2"></label>
                                                </div>
                                                <div class="d_inf11 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf11" value="valuable" id="inf11_2">
                                                    <label for="inf11_2"></label>
                                                </div>
                                                <div class="d_inf12 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf12" value="valuable" id="inf12_2">
                                                    <label for="inf12_2"></label>
                                                </div>
                                                <div class="d_inf13 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf13" value="valuable" id="inf13_2">
                                                    <label for="inf13_2"></label>
                                                </div>
                                                <div class="d_inf14 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf14" value="valuable" id="inf14_2">
                                                    <label for="inf14_2"></label>
                                                </div>
                                                <div class="d_inf15 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf15" value="valuable" id="inf15_2">
                                                    <label for="inf15_2"></label>
                                                </div>
                                                <div class="d_inf16 diente">
                                                    <input type="checkbox" class="diente_inf" name="inf16" value="valuable" id="inf16_2">
                                                    <label for="inf16_2"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">
                                            {:L('SURGERYSYSTEM')}
                                        </label>
                                        <div class="col-sm-4">
                                            <select name="" id="" @change="step5brand" class=" form-control">
                                                <option value="">{:L('PLEASE_SELECT')}</option>
                                                <option :value="item.key" v-for="(item , $index) in step5.brandArr" :index="$index">{{ item.value }}</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">
                                            {:L('OPTOOL')}
                                        </label>
                                        <div class="col-sm-4">
                                            <select name=""  @change="step5tool" class=" form-control">
                                                <option value="">{:L('PLEASE_SELECT')}</option>
                                                <option :value="item.key" v-for="(item , $index) in step5.toolArr" :index="$index">{{ item.value }}</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group iviews-actions">
                                        <div class="col-sm-3 col-sm-offset-1">
                                            <button type="button" class="btn btn-primary btn-block" @click="step5submit">{:L('NEXT')}</button>
                                        </div>
                                    </div>
                                </form>
                            </div>

                        </div>
                        <!-- step6// -->
                        <div class="iviews-order-content iviews-order-step6" v-show="stepArr[5].show">

                            <div class="iviews-order-form">
                                <div class="form-horizontal">

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('KNMX')}</label>
                                        <div class="col-sm-4">
                                            <select name="" class="ui-select form-control" @change="step6modal">
                                                <option :value="item.d_key" :index="$index" v-for="(item , $index) in step6.modalArr">{{ item.d_value }}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group" id="knmx_pic" style="display: none">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('MBZP')}</label>
                                        <div class="col-sm-4">
                                            <div style="position: relative;width: 200px;display: inline-block;margin-right: 10px;" id="pic_div3">
                                                <div class="form-item" style="border: 0; line-height: 52px;">
                                                    <input type="hidden" id="pic3" name="pic3" />
                                                    <div class="fl ">
                                                        <script type="text/template" id="qq-template-validation-license3">
                                                            <div class="qq-uploader-selector">
                                                                <ul class="qq-upload-list-selector" aria-live="polite"
                                                                    aria-relevant="additions removals">
                                                                    <li class="pli">
                                                                        <img class="qq-thumbnail-selector" qq-max-size="200" qq-server-scale style="">
                                                                        <div class="pdel">
                                                                            <button type="button"
                                                                                    style="background: none;border: 0;height:20px;width:20px;margin-top: -30px;" class="qq-btn qq-upload-cancel-selector qq-upload-cancel" id="license_cance3">
                                                                            </button>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                                <div class="qq-upload-button-selector qq-upload-button" id="license_button3">
                                                                    <div></div>
                                                                </div>

                                                            </div>
                                                        </script>
                                                        <div id="fine-uploader-license3">
                                                        </div>
                                                    </div>
                                                    <div class="cl"></div>
                                                    <i class="i-status"></i>
                                                </div>
                                                <div class="input-tip">
                                                    <span></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>
                                    <div class="form-group">
                                        <label class="col-sm-11 col-sm-offset-1 control-label border-l">上传CBCT数据</label>
                                    </div>

                                    <div class="form-group form-group-cbct" id="drop-zone">
                                        <div class="col-sm-11 col-sm-offset-1">
                                            <div class="form-group-cbct-file">
                                                上传文件夹
                                                <input type='file' name='filesToUpload[]' id='filesToUpload' multiple="multiple" webkitdirectory directory/>
                                            </div>
                                            <div class="row" id="drop-show">
                                                <div class="col-sm-12  form-group-cbct-item">
                                                    <span class="folder-name">文件夹名称</span>
                                                    <span class="folder-length">共340个文件</span>
                                                    <span class="folder-size">1.2GB</span>
                                                    <span class="folder-see">[查看]</span>
                                                    <span class="folder-del">[删除]</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group" style="position: relative;">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">CBCT</label>
                                        <div class="col-sm-4">
                                            <form id="my-awesome-dropzone" class="dropzone" action="#" style="min-height: 100px; background: #f7f7f7; padding-top: 0;">
                                                <div class="dropzone-previews"></div>
                                            </form>
                                        </div>
                                        <!-- <span class="iviews-file">上传图片</span> -->
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('KNZP')}</label>
                                        <div class="col-sm-4">
                                            <div style="position: relative;width: 200px;display: inline-block;margin-right: 10px;" id="pic_div">
                                                <div class="form-item" style="border: 0; line-height: 52px;">
                                                    <input type="hidden" id="pic1" name="pic2" />
                                                    <div class="fl ">
                                                        <script type="text/template" id="qq-template-validation-license">
                                                            <div class="qq-uploader-selector">
                                                                <ul class="qq-upload-list-selector" aria-live="polite"
                                                                    aria-relevant="additions removals">
                                                                    <li class="pli">
                                                                        <img class="qq-thumbnail-selector" qq-max-size="200" qq-server-scale style="">
                                                                        <div class="pdel">
                                                                            <button type="button"
                                                                                    style="background: none;border: 0;height:20px;width:20px;margin-top: -30px;" class="qq-btn qq-upload-cancel-selector qq-upload-cancel" id="license_cancel">
                                                                            </button>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                                <div class="qq-upload-button-selector qq-upload-button" id="license_button">
                                                                    <div></div>
                                                                </div>

                                                            </div>
                                                        </script>
                                                        <div id="fine-uploader-license">
                                                        </div>
                                                    </div>
                                                    <div class="cl"></div>
                                                    <i class="i-status"></i>
                                                </div>
                                                <div class="input-tip">
                                                    <span></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('MBZP')}</label>
                                        <div class="col-sm-4">
                                            <div style="position: relative;width: 200px;display: inline-block;margin-right: 10px;" id="pic_div2">
                                                <div class="form-item" style="border: 0; line-height: 52px;">
                                                    <input type="hidden" id="pic2" name="pic2" />
                                                    <div class="fl ">
                                                        <script type="text/template" id="qq-template-validation-license2">
                                                            <div class="qq-uploader-selector">
                                                                <ul class="qq-upload-list-selector" aria-live="polite"
                                                                    aria-relevant="additions removals">
                                                                    <li class="pli">
                                                                        <img class="qq-thumbnail-selector" qq-max-size="200" qq-server-scale style="">
                                                                        <div class="pdel">
                                                                            <button type="button"
                                                                                    style="background: none;border: 0;height:20px;width:20px;margin-top: -30px;" class="qq-btn qq-upload-cancel-selector qq-upload-cancel" id="license_cancel">
                                                                            </button>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                                <div class="qq-upload-button-selector qq-upload-button" id="license_button2">
                                                                    <div></div>
                                                                </div>

                                                            </div>
                                                        </script>
                                                        <div id="fine-uploader-license2">
                                                        </div>
                                                    </div>
                                                    <div class="cl"></div>
                                                    <i class="i-status"></i>
                                                </div>
                                                <div class="input-tip">
                                                    <span></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('HGDY')}</label>
                                        <div class="col-sm-1">
                                            <div class="i-checks">
                                                <label class="control-label">
                                                    <input type="radio" name="hegu" value="1" :checked="step6.hegu == 1">
                                                    <i></i> {:L('YES')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-1">
                                            <div class="i-checks">
                                                <label class="control-label">
                                                    <input type="radio" name="hegu" value="0" :checked="step6.hegu == 0">
                                                    <i></i> {:L('NO')}
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">{:L('MXDY')}</label>
                                        <div class="col-sm-1">
                                            <div class="i-checks">
                                                <label class="control-label">
                                                    <input type="radio" name="moxing" value="1" :checked="step6.moxing == 1">
                                                    <i></i> {:L('YES')}
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-1">
                                            <div class="i-checks">
                                                <label class="control-label">
                                                    <input type="radio" name="moxing" value="0" checked="step6.moxing == 0">
                                                    <i></i> {:L('NO')}
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group iviews-actions">
                                        <div class="col-sm-3 col-sm-offset-1">
                                            <button type="button" class="btn btn-primary btn-block" @click="step6submit">{:L('NEXT')}</button>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                        <!-- step7// -->
                        <div class="iviews-order-content iviews-order-step7" v-show="stepArr[6].show">

                            <div class="iviews-order-form">
                                <form method="" class="form-horizontal">

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">服务类型</label>
                                        <div class="col-sm-1">
                                            <p class="form-control-static">{{ step1.type | servetype }}</p>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">服务内容</label>
                                        <div class="col-sm-2">
                                            <p class="form-control-static">
                                                加工方案:
                                                <span v-for="(item , $index) in step2.type" :index="$index">{{ item }} &emsp;</span>
                                            </p>
                                        </div>
                                        <div class="col-sm-2">
                                            <p class="form-control-static">
                                                普通服务内容:
                                                {{ step2.server }}
                                            </p>
                                        </div>
                                        <div class="col-sm-2" v-if="step2.other > 0">
                                            <p class="form-control-static">
                                                其他服务内容
                                                <span v-for="(item , $index) in step2.other" :index="$index">{{ item }} &emsp;</span>
                                            </p>
                                        </div>
                                        <div class="col-sm-2">
                                            <p class="form-control-static">加急: {{ step2.urgent == 1 ? '是' : '否' }}</p>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">客户信息</label>
                                        <div class="col-sm-9">
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <p class="form-control-static">诊所信息: {{step3.mailing.name}} &emsp; {{step3.mailing.phone}} &emsp; {{step3.mailing.address}}</p>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <p class="form-control-static">诊所信息: {{ step3.clinic.name }} &emsp; {{ step3.clinic.address }}</p>
                                                </div>
                                            </div>
                                            <br>
                                            <div class="row">
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        主治医生: {{step3.team.doctor}}
                                                    </p>
                                                </div>
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        医生助理: {{step3.team.doctorAssistant}}
                                                    </p>
                                                </div>
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">转诊医生: {{step3.team.referralDoctor}}</p>
                                                </div>
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">转诊助理: {{step3.team.referralAssistant}}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">患者信息</label>
                                        <div class="col-sm-9">
                                            <div class="row">
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        姓名: {{ step4.patient.name }}
                                                    </p>
                                                </div>
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        性别: {{ step4.patient.sex == 1 ? '男' : '女' }}
                                                    </p>
                                                </div>
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        出生日期: {{ step4.patient.birthday }}
                                                    </p>
                                                </div>
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        年龄: {{ step4.patient.age }}
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <label class="col-sm-1 control-label" style="text-align: left">患者主诉:</label>
                                                <div class="col-sm-11" v-html="step4.note.patient">

                                                </div>
                                            </div>
                                            <div class="row">
                                                <label class="col-sm-1 control-label" style="text-align: left">既往病史:</label>
                                                <div class="col-sm-11" v-html="step4.note.case"></div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        修复体: {{ step4.repair == 1 ? '有' : '无' }}
                                                    </p>
                                                </div>
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        牙周炎: {{ step4.inflammation | inflafilter }}
                                                    </p>
                                                </div>
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        牙齿松动: {{ step4.pine | pinefilter }}
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        {{ step4.serve }}
                                                    </p>
                                                </div>
                                                <div class="col-sm-3">
                                                    <p class="form-control-static">
                                                        计划手术时间: {{ step4.date }}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">牙位标记</label>
                                        <div class="col-sm-9">
                                            <div class="row iviews-yawei">
                                                <div class="col-sm-4">
                                                    <img :src="step5.lackBase64" alt="">
                                                    <span>缺失牙位标记</span>
                                                </div>
                                                <div class="col-sm-4">
                                                    <img :src="step5.plantBase64" alt="">
                                                    <span>拟种牙位标记</span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-4">
                                                    <p class="form-control-static">种植体品牌及型号: {{ step5.brand }}</p>
                                                </div>
                                                <div class="col-sm-4">
                                                    <p class="form-control-static">手术工具: {{ step5.tool }}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-1 control-label border-l">病例资料</label>
                                        <div class="col-sm-9">
                                            <div class="row">
                                                <label class="col-sm-1 control-label">口内模型:</label>
                                                <div class="col-sm-11">
                                                    <p class="form-control-static">{{ step6.modal }}</p>
                                                </div>
                                            </div>
                                            <div class="row iviews-cbct">
                                                <label class="col-sm-1 control-label"> CBCT:</label>
                                                <div class="col-sm-11">
                                                    <img :src="item" :index="$index" alt="" v-for="(item , $index) in step6.cbct">
                                                </div>
                                            </div>
                                            <div class="row iviews-cbct">
                                                <label class="col-sm-1 control-label"> 口内照片:</label>
                                                <div class="col-sm-3">
                                                    <img :src="step6.photo" >
                                                </div>
                                                <label class="col-sm-1 control-label"> 面部照片:</label>
                                                <div class="col-sm-3">
                                                    <img :src="step6.face" >
                                                </div>
                                            </div>
                                            <div class="row">
                                                <label class="col-sm-1 control-label"> 颌骨打印:</label>
                                                <div class="col-sm-1">
                                                    <p class="form-control-static">{{ step6.hegu == '1' ? '是' : '否' }}</p>
                                                </div>
                                                <label class="col-sm-1 control-label"> 模型打印:</label>
                                                <div class="col-sm-1">
                                                    <p class="form-control-static">{{ step6.moxing == '1' ? '是' : '否' }}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="hr-line-dashed"></div>

                                    <div class="form-group iviews-actions">
                                        <strong class="col-sm-11 col-sm-offset-1">
                                            金额合计: ¥145422.2
                                        </strong>
                                        <div class="col-sm-3 col-sm-offset-1">
                                            <button type="button" class="btn btn-primary btn-block" @click="step4submit">下一步</button>
                                        </div>
                                    </div>
                                </form>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <script>

        // jquery
        // 算高
        $(function(){
            var $minHeight = 0,
                $winHeight = $(window).height(),
                $navHeight = $('.navbar').height(),
                $fooHeight = $('.footer').height(),
                $padHeight = 120,
                $pahHeight = $('.page-heading').height();

            $('#page-wrapper').css('min-height', $winHeight);
            $('.iviews-order').css('min-height', $winHeight - $navHeight - $fooHeight - $padHeight - $pahHeight);

            function removeByValue(arr, val) {
                for (var i = 0; i < arr.length; i++) {
                    if (arr[i] == val) {
                        arr.splice(i, 1);
                        break;
                    }
                }
            }

            $('.iviews-order-step2 input[name="step2type"]').on('ifChecked', function () {
                // alert( );
                $(this).closest('.form-group').removeClass('has-error');
                order.step2.type.push($(this).val());
            })

            $('.iviews-order-step2 input[name="step2type"]').on('ifUnchecked', function () {
                removeByValue(order.step2.type,$(this).val());
            })

            $('.iviews-order-step2 input[name="step2Urgent"]').on('ifChecked', function () {
                order.step2.urgent = $(this).val();
            })

            $('.iviews-order-step2 input[name="hegu"]').on('ifChecked', function () {
                order.step6.hegu = $(this).val();
            })

            $('.iviews-order-step2 input[name="moxing"]').on('ifChecked', function () {
                order.step6.moxing = $(this).val();
            })

            $('.iviews-order-step4 input[name="sex"]').on('ifChecked', function () {
                order.step4.patient.sex = $(this).val();
            })

            $('.iviews-order-step4 input[name="xiufu"]').on('ifChecked', function () {
                order.step4.repair = $(this).val();
            })

            $('.iviews-order-step4 input[name="yan"]').on('ifChecked', function () {
                order.step4.inflammation = $(this).val();
            })

            $('.iviews-order-step4 input[name="song"]').on('ifChecked', function () {
                order.step4.pine = $(this).val();
            })

            // $('.iviews-order-step2 .iviews-type li').on('click', function(){
                // $(this).addClass('active').siblings().removeClass('active');
                // order.step2.other = $(this).text();
            // })
            // order.step3.mailing.address='ssss'


            function handleDragOver(evt) {
                evt.stopPropagation();
                evt.preventDefault();
                evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
            }
            var dropZone = document.getElementById('drop-zone');
            dropZone.addEventListener('dragover', handleDragOver, false);

            function handleFileSelect(evt) {
                evt.stopPropagation();
                evt.preventDefault();
                var files = [], folder = '',
                    items = evt.dataTransfer.items;
                function folderRead(entry,ordername) {
                    console.log(entry);
                    var folderObj = { name: entry.name, id: ordername, file: [] }

                    order.step6.folder.map((item,index)=>{
                        if( item.name == entry.name || item.id == ordername ) {
                            return false;
                        }
                    })

                    entry.createReader().readEntries(function (entries) {
                        folderObj.length = entries.length;
                        for (var i = 0; i < entries.length; i++) {
                            var entrys = entries[i];
                            console.log(entrys)

                            if (entrys.isFile) {
                                entrys.file(function (file) {
                                    var fileObj = { name: file.name, size: file.size }
                                    xhr = new XMLHttpRequest();
                                    xhr.open("post", "{:U('Dentist/Order/uploadFile')}", true);
                                    xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");
                                    var fd = new FormData();
                                    fd.append('mypic', file);
                                    xhr.send(fd);

                                    // 这样没问题
                                    // folderObj.file.push(fileObj)

                                    // 这个待测试
                                    if (xhr.readyState == 4) {
                                        if (xhr.status == 200) {
                                            folderObj.file.push(fileObj)
                                            console.log('success');
                                        }
                                    }
                                })
                            } else {
                                folder = entrys.name;
                            }
                        }
                    });

                    order.step6.folder.push(folderObj)
                }
                for (var i = 0; i < items.length; i++) {
                    var entry = items[i].webkitGetAsEntry();
                    if (!entry) {
                        return;
                    }
                    if (entry.isFile) {
                        alert("请上传文件夹");
                    } else {
                        folderRead(entry, 'esc0001');
                    }
                }
            }
            dropZone.addEventListener('drop', handleFileSelect, false);

        });
        // E1205525
        var data = {};

        // data.step1Type = order.step4.note.patient;
        // vue
        var $serverArr = {$costplan};
        var $repairtype = {$repairtype};
        var $dentist = {$dentist};
        var $addr = {$addr};
        if($addr != null){
            var $address = $addr['regionname']+' '+$addr['addr'];
        }
        if($dentist != null){
            var $clinic_address = $dentist['regionname']+' '+$dentist['addr'];
            var $clinic_name = $dentist['name'];
            var $clinic_phone = $dentist['tel'];
        }
        var order = new Vue({
            el: '#app',
            data () {
                return {
                    stepArr: [
                        { name: "{:L('SERVICE_TYPE')}", show: false, error: false, active: false } ,
                        { name: "{:L('SERVICE_CONTENT')}", show: false, error: false, active: true },
                        { name: "{:L('CUSTOMER_INFO')}", show: false, error: false, active: true },
                        { name: "{:L('PATIENT_INFO')}", show: false, error: false, active: true },
                        { name: "{:L('TOOTH')}", show: false, error: false, active: true },
                        { name: "{:L('DATUM')}", show: true, error: false, active: true },
                        { name: "{:L('SUBMIT_ORDER')}", show: false, error: false, active: false }
                    ],
                    stepIndex: 1,
                    step1: {
                        type: 1          // 1.种植  2.固定正畸  3.隐形正畸
                    },
                    step2: {
                        type: [],         // true 设计方案 false 模型方案
                        urgent: false,       // true 加急  false 未加急
                        server: '', // 普通服务内容 默认值可以取serverArr[0]
                        // serverArr: ['单齿种植','多齿种植'], // 普通服务内容选项
                        serverArr: $serverArr,
                        other: [], // 其他服务内容 默认值可以取otherArr[0]
                        otherArr: {$costplan1} // 其他服务内容选项
                    },
                    step3: {
                        clinic: {
                            name: $clinic_name,       //  诊所名字
                            address: $clinic_address     //  诊所地址
                        },
                        mailing: {
                            name: $clinic_name,         //  医生名字
                            phone: $clinic_phone,  //  医生电话
                            address: $address     //  医生地址
                        },
                        team: {
                            doctor: '',            //  主治医师
                            doctorAssistant: '',   //  医生助理
                            referralDoctor: '',    //  转诊医生
                            referralAssistant: '',  //  转诊助理
                            doctorTel: '',            //  主治医师
                            doctorAssistantTel: '',   //  医生助理
                            referralDoctorTel: '',    //  转诊医生
                            referralAssistantTel: ''  //  转诊助理
                        }
                    },
                    step4: {
                        patient: {
                            name: '',            //  患者姓名
                            sex: 1,              //  1. 男  2. 女
                            age: '',             //  年龄
                            birthday: '' //  生日
                        },
                        note: {
                            patient: '',        //  患者主诉
                        },
                        repair: {
                            key:'',
                            value:'',
                        },              //  修复体
                        inflammation:  {
                            key:'',
                            value:'',
                        },                //  牙周炎
                        pine: {
                            key:'',
                            value:'',
                        },                         //  牙齿松动
                        repairtype: '',       //  普通服务内容
                        repairtypeArr: $repairtype,       //  普通服务内容
                        date: ''      //  预计手术时间
                    },
                    step5: {
                        brand: 1,                 //  种植体品牌及型号 默认可以为brandArr[0]
                        brandArr: [
                            { key: '1', value: '品牌1' },
                            { key: '2', value: '品牌2' }
                        ],    //  种植体品牌型号选项
                        tool: 1,                  //  手术工具 默认可以为tooArr[0]
                        toolArr: [
                            { key: '1', value: '工具1' },
                            { key: '2', value: '工具2' }
                        ],     //  手术工具备选项
                        lack: [],                      //   缺失牙位标记 目前存的是name 例如sup9=> 上面第九  inf3 下面第三
                        plant: [],                     //  拟种植牙位标记 存的数据同上
                        lackBase64: '',                //  缺失牙位的jpg图 base64格式
                        plantBase64: ''                //  拟种植牙位的jpg图 base64格式
                    },
                    step6: {
                        modal: '口内模型',              //  口内模型
                        modalArr: {$mmodel}, // 口内模型备选项
                        folder: [
                            // {
                            //     name: '',
                            //     file: []
                            // }
                        ] ,     // cbct图片 base64
                        photo: '',     // 口内图片 base64
                        face: '',      // 脸部图片 base64
                        hegu: 0,       // 颌骨打印
                        moxing: 0      // 模型打印
                    },
                }
            },
            filters: {
                servetype (val) {
                    switch (val) {
                        case 1:
                            return '种植';
                            break;
                        case 2:
                            return '固定正畸';
                            break
                        case 3:
                            return '隐形正畸';
                            break;
                    }
                },
                inflafilter (val) {
                    switch (val) {
                        case 1:
                            return '重度';
                            break;
                        case 2:
                            return '轻度';
                            break;
                        case 3:
                            return '无';
                            break;
                    }
                },
                pinefilter (val) {
                    switch (val) {
                        case 1:
                            return 'Ⅰ°';
                            break;
                        case 2:
                            return 'Ⅱ°';
                            break;
                        case 3:
                            return 'Ⅲ°';
                            break;
                    }
                }
            },
            mounted () {


                this.step2.type.map((item,index)=>{
                    if ( $('input[name="step2type"]').val() == item ) {
                        $('input[name="step2type"]').prop('checked',true);
                    }
                })
                function removeByValue(arr, val) {
                    for (var i = 0; i < arr.length; i++) {
                        if (arr[i] == val) {
                            arr.splice(i, 1);
                            break;
                        }
                    }
                }
                $('.iviews-order-step2 .iviews-type li').on('click', function(){
                    $(this).toggleClass('active');

                    if ( $(this).hasClass('active') ) {
                        order.step2.other.push($(this).attr('value'))
                    } else {
                        removeByValue(order.step2.other,$(this).attr('value'))
                    }
                })

                // plugin init
                $('.i-checks').iCheck({
                    checkboxClass: 'icheckbox_square-green',
                    radioClass: 'icheckbox_square-green',
                });

                // datepicker
                $('#birthday .date , #surgery .date').datepicker({
                    todayBtn: "linked",
                    keyboardNavigation: false,
                    forceParse: false,
                    calendarWeeks: false,
                    autoclose: true,
                    format: 'yyyy-mm-dd'
                });

                // ckeditor
                CKEDITOR.replace('note1');

                $('.iviews-order-step4 .iviews-actions .btn').on('click', function(){
                    order.step4.note.patient = CKEDITOR.instances.note1.getData()
                })

            },
            methods: {
                tab(index) {
                    if ( index === 0 ) {
                        return false;
                    }
                    if (this.stepArr[index].active) {
                        this.stepArr.map((item, $index) => {
                            item.show = false;
                        })
                        this.stepArr[index].show = true;
                    }
                },
                rclass (ele) {
                    if ( $('input[name="' + ele.target.name + '"]').val().length >= 1 ) {
                        $('input[name="'+ele.target.name+'"]').closest('.form-group').removeClass('has-error');
                    }
                },
                // step1
                step1Type (index) {
                    this.step1.type = index;
                    this.stepArr[0].show = false;
                    this.stepArr[1].show = true;
                    this.stepArr[1].active = true;
                },
                // step2
                step2Server (ele) {
                    if ( $('.iviews-order-form').hasClass('has-error') ) {
                        $('.iviews-order-form').removeClass('has-error')
                    }
                    this.step2.server = ele.target.value;
                },
                step2Other (name) {
                    this.step2.other.push(name);
                },
                step2submit () {
                    if ( this.step2.type == '' ) {
                        $(".iviews-order-step2 [name='step2type']").closest('.form-group').addClass('has-error');
                        return false;
                    }
                    if ( this.step2.server == '' ) {
                        $('.iviews-order-step2 select').closest('.form-group').addClass('has-error');
                        return false;
                    }
                    this.stepArr[1].show = false;
                    this.stepArr[2].show = true;
                    this.stepArr[2].active = true;
                },
                // step3
                step3submit() {
                    if ( this.step3.team.doctor === '' ) {
                        $('.iviews-order-step3 input[name="doctor"]').closest('.form-group').addClass('has-error');
                        return false;
                    }
                    if ( this.step3.team.doctorTel === '' ) {
                        $('.iviews-order-step3 input[name="doctor_tel"]').closest('.form-group').addClass('has-error');
                        return false;
                    }
                    if (this.step3.team.doctorAssistant === '') {
                        $('.iviews-order-step3 input[name="doctorAssistant"]').closest('.form-group').addClass('has-error');
                        return false;
                    }
                    if (this.step3.team.doctorAssistantTel === '') {
                        $('.iviews-order-step3 input[name="doctorAssistant_tel"]').closest('.form-group').addClass('has-error');
                        return false;
                    }
                    this.stepArr[2].show = false;
                    this.stepArr[3].show = true;
                    this.stepArr[3].active = true;
                },
                // step4
                step4repairtype(ele) {
                    this.step4.repairtype = ele.target.value;
                },
                step4submit() {
                    let surgery     =   $('#surgery');
                    let birthday    =   $('#birthday');
                    if ( $('#name4').find('input').val() == '' ) {
                        $('#name4').addClass('has-error');
                        return false;
                    }
                    if ( birthday.find('input').val() == '' ) {
                        birthday.addClass('has-error');
                        return false;
                    }
                    if ( surgery.find('input').val() == '' ) {
                        surgery.addClass('has-error');
                        return false;
                    }
                    // this.step4.note.patient = $('textarea[name="note1"]').val();
                    // this.step4.note.case = $('textarea[name="note2"]').val();
                    this.stepArr[3].show = false;
                    this.stepArr[4].show = true;
                    this.stepArr[4].active = true;
                },
                // step5
                step5brand(ele) {
                    this.step5.brand = ele.target.value;
                },
                step5tool(ele) {
                    this.step5.tool = ele.target.value;
                },
                step5submit() {
                    let dom1 = $('#pz_dentales').clone();
                    let dom2 = $('#pz_dentales_2').clone();
                    dom1.addClass('canvas1');
                    dom2.addClass('canvas2');
                    dom1.css({
                        'position': 'fixed',
                        'right': '0',
                        'bottom': '0',
                        'z-index': '-1'
                    })
                    dom2.css({
                        'position': 'fixed',
                        'right': '0',
                        'bottom': '0',
                        'z-index': '-1'
                    })
                    $('body').append(dom1);
                    $('body').append(dom2);

                    for ( let i = 0; i < $('#img_pz input[type="checkbox"]:checked').length; i++ ) {
                        this.step5.lack.push($('#img_pz input[type="checkbox"]:checked').eq(i).attr('name'));
                    }
                    for (let i = 0; i < $('#img_pz_2 input[type="checkbox"]:checked').length; i++) {
                        this.step5.plant.push($('#img_pz_2 input[type="checkbox"]:checked').eq(i).attr('name'));
                    }
                    let s5 = this.step5;
                    html2canvas($('.canvas1'),{
                        allowTaint: true,
                        taintTest: false,
                        onrendered: function (canvas) {
                            s5.lackBase64 = canvas.toDataURL("image/jpeg", 1.0);
                        }
                    });
                    html2canvas($('.canvas2'), {
                        allowTaint: true,
                        taintTest: false,
                        onrendered: function (canvas) {
                            s5.plantBase64 = canvas.toDataURL("image/jpeg", 1.0);
                        }
                    });
                    // html2canvas(document.getElementById('pz_dentales_2')).then(function (canvas) {
                    //     s5.plantBase64 = canvas.toDataURL();
                    //     console.log(canvas.toDataURL());
                    // });
                    this.stepArr[4].show = false;
                    this.stepArr[5].show = true;
                    this.stepArr[5].active = true;
                },
                // step6
                step6modal(ele) {
                    this.step5.modal = ele.target.value;
                },
                step6submit() {
                    // my-awesome-dropzone
                    for ( var i = 0; i < $('#my-awesome-dropzone').find('.dz-image-preview').length; i++ ) {
                        this.step6.cbct.push($('#my-awesome-dropzone .dz-image-preview').eq(i).find('img').attr('src'));
                    }

                    for (var i = 0; i < $('#my-awesome-dropzone1').find('.dz-image-preview').length; i++) {
                        this.step6.photo.push($('#my-awesome-dropzone1 .dz-image-preview').eq(i).find('img').attr('src'));
                    }

                    for (var i = 0; i < $('#my-awesome-dropzone2').find('.dz-image-preview').length; i++) {
                        this.step6.face.push($('#my-awesome-dropzone2 .dz-image-preview').eq(i).find('img').attr('src'));
                    }

                    this.stepArr[5].show = false;
                    this.stepArr[6].show = true;
                    this.stepArr[6].active = true;
                },
            }
        });
        var restrictedUploader = new qq.FineUploader({
            element: document.getElementById("fine-uploader-license2"),
            template: 'qq-template-validation-license2',
            request: {
                endpoint: "{:U('Order/uploadPic')}",
                method: 'POST' // Only for the gh-pages demo website due to Github Pages limitations
            },
            thumbnails: {
                placeholders: {
                    waitingPath: '__JSNEW__/all.fine-uploader/placeholders/waiting-generic.png',
                    notAvailablePath: '__JSNEW__/all.fine-uploader/placeholders/not_available-generic.png'
                }
            },
            validation: {
                allowedExtensions: ['jpeg', 'jpg', 'png','gif'],
                itemLimit: 1,
            },
            debug: true,
            callbacks: {
                onSubmit: function(id, fileName) {
                    $("#license_button2").hide();
                    $("#fine-uploader-license2").parent().parent().removeClass("form-item-error");
                    $("#fine-uploader-license2").parent().parent().addClass("form-item-valid");
                    $("#license-error").text("");
                    $("#license-error").attr("id","");
                },
                onCancel: function(id, fileName) {
                    $("#license_button2").show();
                    $("#lpic2").val("");
                },
                onComplete:  function(id,  fileName,  responseJSON)  {
                    if(responseJSON.success){

                        $("#license_cancel2").show();
                        order.step6.face = responseJSON.uploadName;
                    }else{
                        $("#license_button2").click();
                    }
                }
            }
        });
        var restrictedUploader = new qq.FineUploader({
            element: document.getElementById("fine-uploader-license"),
            template: 'qq-template-validation-license',
            request: {
                endpoint: "{:U('Order/uploadPic')}",
                method: 'POST' // Only for the gh-pages demo website due to Github Pages limitations
            },
            thumbnails: {
                placeholders: {
                    waitingPath: '__JSNEW__/all.fine-uploader/placeholders/waiting-generic.png',
                    notAvailablePath: '__JSNEW__/all.fine-uploader/placeholders/not_available-generic.png'
                }
            },
            validation: {
                allowedExtensions: ['jpeg', 'jpg', 'png','gif'],
                itemLimit: 1,
            },
            debug: true,
            callbacks: {
                onSubmit: function(id, fileName) {
                    $("#license_button").hide();
                    $("#fine-uploader-license").parent().parent().removeClass("form-item-error");
                    $("#fine-uploader-license").parent().parent().addClass("form-item-valid");
                    $("#license-error").text("");
                    $("#license-error").attr("id","");
                },
                onCancel: function(id, fileName) {
                    $("#license_button").show();
                    $("#pic1").val("");
                },
                onComplete:  function(id,  fileName,  responseJSON)  {
                    if(responseJSON.success){
                        $("#license_cancel").show();
                        order.step6.photo = responseJSON.uploadName;
                    }else{
                        $("#license_button").click();
                    }
                }
            }
        });
    </script>
</block>

